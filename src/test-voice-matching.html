<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŸ³å£°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ç…§åˆãƒ†ã‚¹ãƒˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-lg p-8">
        <h1 class="text-3xl font-bold text-indigo-900 mb-6">éŸ³å£°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ç…§åˆãƒ­ã‚¸ãƒƒã‚¯ ãƒ†ã‚¹ãƒˆ</h1>
        
        <div class="mb-6">
            <h2 class="text-xl font-semibold mb-4">ãƒ†ã‚¹ãƒˆçµæœ</h2>
            <div id="test-results" class="space-y-2"></div>
        </div>
        
        <div class="mt-6">
            <button id="run-tests" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg">
                ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
            </button>
        </div>
    </div>

    <script>
        // LocalStorageã‚­ãƒ¼ï¼ˆå®Ÿéš›ã®ã‚¢ãƒ—ãƒªã¨åŒã˜ï¼‰
        // æ³¨æ„: ã“ã®å®šæ•°ã¯ src/js/script.js ã® STORAGE_KEY_VOICE_PROFILE_ID ã¨åŒæœŸã•ã›ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
        const STORAGE_KEY_VOICE_PROFILE_ID = 'azure_voice_profile_id';

        // identifySpeakeré–¢æ•°ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ã‹ã‚‰æŠ½å‡ºï¼‰
        function identifySpeaker(speakerId) {
            console.log('ğŸ” [è©±è€…è­˜åˆ¥å‡¦ç†] ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ID:', speakerId);
            
            // LocalStorageã‹ã‚‰ç™»éŒ²ã•ã‚ŒãŸä¸Šå¸ã®ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼IDã‚’å–å¾—
            const registeredManagerId = localStorage.getItem(STORAGE_KEY_VOICE_PROFILE_ID);
            
            // ç™»éŒ²ã•ã‚Œã¦ã„ãªã„å ´åˆã¯éƒ¨ä¸‹ã¨ã—ã¦æ‰±ã†
            if (!registeredManagerId) {
                console.log('âš ï¸ [æ³¨æ„] ä¸Šå¸ã®ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼IDãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“');
                console.log('ğŸ“Œ [åˆ¤å®š] ç™»éŒ²ãªã— â†’ éƒ¨ä¸‹ã¨ã—ã¦è­˜åˆ¥');
                return false;
            }
            
            console.log('ğŸ“‹ [éŸ³å£°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ç…§åˆ]', {
                ç¾åœ¨ã®è©±è€…ID: speakerId,
                ç™»éŒ²ã•ã‚ŒãŸä¸Šå¸ID: registeredManagerId,
                ç…§åˆå‡¦ç†: 'å®Ÿæ–½ä¸­'
            });
            
            // ç™»éŒ²ã•ã‚ŒãŸã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼IDã¨ç¾åœ¨ã®è©±è€…IDã‚’ç…§åˆ
            const isManager = (speakerId === registeredManagerId);
            
            console.log('âœ… ========== è©±è€…è­˜åˆ¥çµæœ ==========');
            console.log('ğŸ“Œ [ç…§åˆçµæœ]', { 
                ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ID: speakerId,
                ç™»éŒ²ã•ã‚ŒãŸä¸Šå¸ã®ID: registeredManagerId,
                IDã®ä¸€è‡´: isManager ? 'ã¯ã„ï¼ˆä¸Šå¸ï¼‰' : 'ã„ã„ãˆï¼ˆéƒ¨ä¸‹ï¼‰',
                æœ€çµ‚åˆ¤å®š: isManager ? 'ä¸Šå¸' : 'éƒ¨ä¸‹'
            });
            console.log('ğŸ“Œ [ç¢ºèª] ç™»éŒ²ã•ã‚ŒãŸéŸ³å£°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã®ç…§åˆã‚’å®Ÿæ–½ã—ã¾ã—ãŸ');
            console.log('=====================================');
            
            return isManager;
        }

        // ãƒ†ã‚¹ãƒˆé–¢æ•°
        function runTests() {
            const resultsContainer = document.getElementById('test-results');
            resultsContainer.innerHTML = '';
            
            let passedTests = 0;
            let totalTests = 0;

            function addTestResult(testName, passed, details) {
                totalTests++;
                if (passed) passedTests++;
                
                const resultDiv = document.createElement('div');
                resultDiv.className = `p-4 rounded ${passed ? 'bg-green-50 border border-green-200' : 'bg-red-50 border border-red-200'}`;
                resultDiv.innerHTML = `
                    <div class="flex items-center">
                        <span class="text-2xl mr-3">${passed ? 'âœ…' : 'âŒ'}</span>
                        <div class="flex-1">
                            <p class="font-semibold ${passed ? 'text-green-800' : 'text-red-800'}">${testName}</p>
                            <p class="text-sm ${passed ? 'text-green-700' : 'text-red-700'}">${details}</p>
                        </div>
                    </div>
                `;
                resultsContainer.appendChild(resultDiv);
            }

            console.log('ğŸ§ª ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹ã—ã¾ã™...');
            console.log('=====================================\n');

            // ãƒ†ã‚¹ãƒˆ1: ç™»éŒ²ã•ã‚ŒãŸã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼IDã¨ä¸€è‡´ã™ã‚‹å ´åˆ
            console.log('ãƒ†ã‚¹ãƒˆ1: ç™»éŒ²ã•ã‚ŒãŸã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼IDã¨ä¸€è‡´ã™ã‚‹å ´åˆ');
            localStorage.setItem(STORAGE_KEY_VOICE_PROFILE_ID, 'Guest-1');
            const result1 = identifySpeaker('Guest-1');
            const test1Passed = result1 === true;
            addTestResult(
                'ãƒ†ã‚¹ãƒˆ1: ç™»éŒ²ã•ã‚ŒãŸã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼IDã¨ä¸€è‡´ã™ã‚‹å ´åˆ',
                test1Passed,
                `ç™»éŒ²ID: Guest-1, å…¥åŠ›ID: Guest-1, çµæœ: ${result1 ? 'ä¸Šå¸' : 'éƒ¨ä¸‹'} (æœŸå¾…å€¤: ä¸Šå¸)`
            );
            console.log('\n');

            // ãƒ†ã‚¹ãƒˆ2: ç™»éŒ²ã•ã‚ŒãŸã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼IDã¨ä¸€è‡´ã—ãªã„å ´åˆ
            console.log('ãƒ†ã‚¹ãƒˆ2: ç™»éŒ²ã•ã‚ŒãŸã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼IDã¨ä¸€è‡´ã—ãªã„å ´åˆ');
            localStorage.setItem(STORAGE_KEY_VOICE_PROFILE_ID, 'Guest-1');
            const result2 = identifySpeaker('Guest-2');
            const test2Passed = result2 === false;
            addTestResult(
                'ãƒ†ã‚¹ãƒˆ2: ç™»éŒ²ã•ã‚ŒãŸã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼IDã¨ä¸€è‡´ã—ãªã„å ´åˆ',
                test2Passed,
                `ç™»éŒ²ID: Guest-1, å…¥åŠ›ID: Guest-2, çµæœ: ${result2 ? 'ä¸Šå¸' : 'éƒ¨ä¸‹'} (æœŸå¾…å€¤: éƒ¨ä¸‹)`
            );
            console.log('\n');

            // ãƒ†ã‚¹ãƒˆ3: è¤‡æ•°ã®éƒ¨ä¸‹ï¼ˆç•°ãªã‚‹ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼IDï¼‰
            console.log('ãƒ†ã‚¹ãƒˆ3: è¤‡æ•°ã®éƒ¨ä¸‹ï¼ˆç•°ãªã‚‹ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼IDï¼‰');
            localStorage.setItem(STORAGE_KEY_VOICE_PROFILE_ID, 'Guest-1');
            const result3a = identifySpeaker('Guest-2');
            const result3b = identifySpeaker('Guest-3');
            const test3Passed = result3a === false && result3b === false;
            addTestResult(
                'ãƒ†ã‚¹ãƒˆ3: è¤‡æ•°ã®éƒ¨ä¸‹ï¼ˆç•°ãªã‚‹ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼IDï¼‰',
                test3Passed,
                `ç™»éŒ²ID: Guest-1, å…¥åŠ›ID: Guest-2, Guest-3, çµæœ: ä¸¡æ–¹ã¨ã‚‚éƒ¨ä¸‹`
            );
            console.log('\n');

            // ãƒ†ã‚¹ãƒˆ4: ä¸Šå¸ãŒè¤‡æ•°å›è©±ã™ï¼ˆåŒã˜ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼IDï¼‰
            console.log('ãƒ†ã‚¹ãƒˆ4: ä¸Šå¸ãŒè¤‡æ•°å›è©±ã™ï¼ˆåŒã˜ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼IDï¼‰');
            localStorage.setItem(STORAGE_KEY_VOICE_PROFILE_ID, 'Guest-1');
            const result4a = identifySpeaker('Guest-1');
            const result4b = identifySpeaker('Guest-1');
            const test4Passed = result4a === true && result4b === true;
            addTestResult(
                'ãƒ†ã‚¹ãƒˆ4: ä¸Šå¸ãŒè¤‡æ•°å›è©±ã™ï¼ˆåŒã˜ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼IDï¼‰',
                test4Passed,
                `ç™»éŒ²ID: Guest-1, å…¥åŠ›ID: Guest-1ï¼ˆ2å›ï¼‰, çµæœ: ä¸¡æ–¹ã¨ã‚‚ä¸Šå¸`
            );
            console.log('\n');

            // ãƒ†ã‚¹ãƒˆ5: ä¼šè©±ã®é †ç•ªã«é–¢ä¿‚ãªãè­˜åˆ¥
            console.log('ãƒ†ã‚¹ãƒˆ5: ä¼šè©±ã®é †ç•ªã«é–¢ä¿‚ãªãè­˜åˆ¥');
            localStorage.setItem(STORAGE_KEY_VOICE_PROFILE_ID, 'Guest-1');
            const result5a = identifySpeaker('Guest-2'); // éƒ¨ä¸‹ãŒå…ˆã«è©±ã™
            const result5b = identifySpeaker('Guest-1'); // ä¸Šå¸ãŒå¾Œã‹ã‚‰è©±ã™
            const test5Passed = result5a === false && result5b === true;
            addTestResult(
                'ãƒ†ã‚¹ãƒˆ5: ä¼šè©±ã®é †ç•ªã«é–¢ä¿‚ãªãè­˜åˆ¥',
                test5Passed,
                `éƒ¨ä¸‹ãŒå…ˆã«è©±ã—ã¦ã‚‚ã€ä¸Šå¸ãŒå¾Œã‹ã‚‰è©±ã—ã¦ã‚‚æ­£ã—ãè­˜åˆ¥ï¼ˆéƒ¨ä¸‹â†’ä¸Šå¸ã®é †ï¼‰`
            );
            console.log('\n');

            // ãƒ†ã‚¹ãƒˆ6: ç™»éŒ²ãŒãªã„å ´åˆ
            console.log('ãƒ†ã‚¹ãƒˆ6: ç™»éŒ²ãŒãªã„å ´åˆ');
            localStorage.removeItem(STORAGE_KEY_VOICE_PROFILE_ID);
            const result6 = identifySpeaker('Guest-1');
            const test6Passed = result6 === false;
            addTestResult(
                'ãƒ†ã‚¹ãƒˆ6: ç™»éŒ²ãŒãªã„å ´åˆ',
                test6Passed,
                `ç™»éŒ²ID: ãªã—, å…¥åŠ›ID: Guest-1, çµæœ: ${result6 ? 'ä¸Šå¸' : 'éƒ¨ä¸‹'} (æœŸå¾…å€¤: éƒ¨ä¸‹)`
            );
            console.log('\n');

            // ãƒ†ã‚¹ãƒˆçµæœã®ã‚µãƒãƒªãƒ¼
            console.log('=====================================');
            console.log('ğŸ¯ ãƒ†ã‚¹ãƒˆçµæœã‚µãƒãƒªãƒ¼');
            console.log(`åˆæ ¼: ${passedTests}/${totalTests}`);
            console.log(`æˆåŠŸç‡: ${((passedTests/totalTests)*100).toFixed(1)}%`);
            console.log('=====================================');

            // ã‚µãƒãƒªãƒ¼ã‚’UIã«è¿½åŠ 
            const summaryDiv = document.createElement('div');
            summaryDiv.className = `p-6 rounded mt-6 ${passedTests === totalTests ? 'bg-green-100 border-2 border-green-400' : 'bg-yellow-100 border-2 border-yellow-400'}`;
            summaryDiv.innerHTML = `
                <h3 class="text-xl font-bold mb-2 ${passedTests === totalTests ? 'text-green-800' : 'text-yellow-800'}">
                    ${passedTests === totalTests ? 'ğŸ‰ ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã«åˆæ ¼ã—ã¾ã—ãŸï¼' : 'âš ï¸ ä¸€éƒ¨ã®ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ã¾ã—ãŸ'}
                </h3>
                <p class="text-lg ${passedTests === totalTests ? 'text-green-700' : 'text-yellow-700'}">
                    åˆæ ¼: ${passedTests}/${totalTests} (æˆåŠŸç‡: ${((passedTests/totalTests)*100).toFixed(1)}%)
                </p>
            `;
            resultsContainer.appendChild(summaryDiv);

            // LocalStorageã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
            localStorage.removeItem(STORAGE_KEY_VOICE_PROFILE_ID);
        }

        // ãƒœã‚¿ãƒ³ã«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®š
        document.getElementById('run-tests').addEventListener('click', runTests);

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«è‡ªå‹•å®Ÿè¡Œ
        console.log('ğŸ“„ ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
        console.log('ã€Œãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹ã—ã¦ãã ã•ã„');
    </script>
</body>
</html>
